decisions = {
	convert_to_aztec_religion = {
		only_playable = yes
		ai_check_interval = 6
		
		#is_high_prio = yes
		
		potential = {
			is_playable = yes
			NOT = { religion_authority = 1 }
			controls_religion = no
			de_facto_liege_title = e_aztec_colony
			NOT = {
				religion = aztec
			}
		}
		
		allow = {
			NOT = { trait = zealous }
		}
		
		effect = {
			prestige = -500
			piety = 100
			religion_authority = {
				modifier = ruler_converted_from
			}
			
			
			if = {
				limit = {  NOT = { religion_group = mesoamerican_group } }
				if = {
					limit = { religion_group = pagan_group }
					add_trait = sympathy_pagans
				}
				
				if = {
					limit = { religion_group = zoroastrian_group }
					add_trait = sympathy_zoroastrianism
				}
				
				if = {
					limit = { religion_group = christian }
					add_trait = sympathy_christendom
				}
				
				if = {
					limit = { religion_group = muslim }
					add_trait = sympathy_islam
				}
				
				if = {
					limit = { religion_group = jewish_group }
					add_trait = sympathy_judaism
				}
				
				if = {
					limit = { religion_group = indian_group }
					add_trait = sympathy_indian
				}
			}
			
			religion = aztec
			capital_scope = {
				religion = aztec
			}
			any_courtier_or_vassal = {
				character_event = { id = misc_american.1 }
			}
			
			hidden_tooltip = {
				religion_authority = {
					modifier = ruler_converted_to
				}
			}
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.05
				is_hard_to_convert = yes
			}
			modifier = {
				factor = 0.05
				trait = zealous
			}
			#modifier = {
			#	factor = 4
			#	NOT = { trait = zealous }
			#}
		}
	}
	
	
	aztec_sends_reinforcements = {
		ai_check_interval = 2
		only_independent = yes
		potential = {
			ai = yes
			#ai = no # Debug
			war = yes
			offmap_aztecs = {
				governor = {
					character = ROOT
				}
				OR = {
					NOT = {
						# Only spawn reinforcements once
						has_offmap_flag = aztecs_sent_war_reinforcements
						# Exception: Really long wars
					}
					had_offmap_tmp_flag = {
						flag = aztecs_sent_war_reinforcements
						years = 30
					}
				}
				# Don't spawn reinforcements for the following statuses in China.
				NOR = {
					has_status = aztec_famine
					has_status = aztec_civil_war
					has_status = aztec_mayan_invasion
					has_status = aztec_incan_invasion
					has_status = aztec_norse_invasion
					has_status = aztec_iroquian_invasion
					has_status = aztec_plague
				}
			}
			# Only if Aztec Empire is losing a war by 50 war score.
			any_war = {
				OR = {
					AND = {
						attacker = {
							character = ROOT
						}
						NOT = { war_score = -49 }
					}
					AND = {
						defender = {
							character = ROOT
						}
						war_score = 50
					}
				}
			}
		}
		allow = {
		}
		effect = {
			capital_scope = {
				save_event_target_as = spawn_province
				set_variable = {
					which = aztec_troop_quantity
					value = 60
				}
				set_variable = {
					which = aztec_troop_quality
					value = 6
				}
				aztec_war_modify_variables_by_status_effect = yes
				aztec_war_modify_variables_by_century_effect = yes
				aztec_war_spawn_troops_effect = yes
			}
			offmap_aztecs = {
				set_offmap_flag = aztecs_sent_war_reinforcements
			}
		}
	}
	
	
}
#Gaining Respect
offmap_decisions = {

	
	aztec_respect_become_tributary = {
		only_independent = yes
		button_name = offmap_gifts
		ai_check_interval = 12

		potential = {
			is_offmap_tag = offmap_aztecs
		}
	
		from_potential = {
			independent = yes
			#has_dlc = "Sunset Invasion"
			mercenary = no
			holy_order = no
			is_landed = yes
		}

		allow = {
			show_only_failed_conditions = yes
			FROM = {
				show_scope_change = no
				war = no
				OR = {
					custom_tooltip = { #Borders the Colony
						text = aztec_respect_become_tributary_allow_colony_neighbor_tt
						any_neighbor_independent_ruler = {
							has_landed_title = e_aztec_colony
						}
					}
					custom_tooltip = { #Borders a Chinese tributary
						text = aztec_respect_become_tributary_allow_tributary_neighbor_tt
						any_neighbor_independent_ruler = {
							suzerain = {
								has_landed_title = e_aztec_colony
							}
						}
					}
					# custom_tooltip = { #Borders the eastern edge of the map
						# text = aztec_respect_become_tributary_allow_chinese_influence_tt
						# any_realm_province = {
							# region = custom_aztec_invasion_target_region
						# }
					# }
					custom_tooltip = { #Within diplo range of China and has a port in India
						text = aztec_respect_become_tributary_allow_europe_tt
						any_realm_province = { 
							port = yes 
							region = world_europe
						}
					}
				}
				custom_tooltip = {
					text = aztec_respect_become_tributary_allow_suzerain_tt
					NOT = {
						is_tributary = yes
					}
				}
				NOT = { tier = emperor }
				custom_tooltip = {
					text = aztecs_respect_become_tributary_cooldown_tt
					NOT = { has_character_modifier = aztecs_respect_tributary_timer }
				}
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
			}
			# china_offmap_decisions_enabled_trigger = yes #leave in please, to be used if the tooltip for china_offmap_tribute_decisions_enabled_trigger changes and we need to reference things uniquely again
			aztec_offmap_tribute_decisions_enabled_trigger = yes
		}

		effect = {
			log = "---------------------"
			log = "Aztec Logging:"
			log = "[From.GetTitledName] has voluntarily become a tributary of the [offmap_aztecs.GetFullname]"
			log = "---------------------"
			make_tributary = {
				who = FROM
				tributary_type = aztec_offmap_trib
			}
			#hidden_effect = { offmap_aztecs = { governor = { character_event = { id = JD.20027 } } } } #CONVERT THIS TO A SI NARRATIVE EVENT
			custom_tooltip = { text = aztec_respect_become_tributary_effect_tt }
			FROM = {
				show_scope_change = no
				sound_effect = aztec_respect_gain
				tooltip = {
					if = {
						limit = {
							liked_by_offmap = {
								type = offmap_aztecs
								context = tributary
							}
							NOT = {
								disliked_by_offmap = {
									type = offmap_aztecs
									context = tributary
								}
							}
						}
						add_offmap_currency = {
							offmap = offmap_aztecs
							value = 400
						}
						e_aztec_colony = {
							show_scope_change = no
							offmap_power = {
								show_scope_change = no
								custom_tooltip = { text = likes_tt }
							}
						}
					}
					if = {
						limit = {
							disliked_by_offmap = {
								type = offmap_aztecs
								context = tributary
							}
							NOT = {
								liked_by_offmap = {
									type = offmap_aztecs
									context = tributary
								}
							}
						}
						add_offmap_currency = {
							offmap = offmap_aztecs
							value = 100
						}
						e_aztec_colony = {
							show_scope_change = no
							offmap_power = {
								show_scope_change = no
								custom_tooltip = { text = dislikes_tt }
							}
						}
					}
					if = {
						limit = {
							liked_by_offmap = {
								type = offmap_aztecs
								context = tributary
							}
							disliked_by_offmap = {
								type = offmap_aztecs
								context = tributary
							}
						}
						add_offmap_currency = {
							offmap = offmap_aztecs
							value = 200
						}
						e_aztec_colony = {
							show_scope_change = no
							offmap_power = {
								show_scope_change = no
								custom_tooltip = { text = likes_but_dislikes_tt }
							}
						}
					}
					if = {
						limit = {
							NOR = {
								liked_by_offmap = {
									type = offmap_aztecs
									context = tributary
								}
								disliked_by_offmap = {
									type = offmap_aztecs
									context = tributary
								}
							}
						}
						add_offmap_currency = {
							offmap = offmap_aztecs
							value = 200
						}
					}
				}
			}
		}

		ai_will_do = {
			factor = 0
			#modifier = {
			#	factor = 0.01 # slow down
			#}
			modifier = { realm_levy_diff = { who = FROM value = 2000 } factor = 1.5 }
			modifier = { realm_levy_diff = { who = FROM value = 5000 } factor = 3 }
		}
	}


	aztec_respect_offer_gladiator = { #Sent to tenochtitlan to participate in gladiatorial combat. Will upset family. Will get more resepct for better mil stats (better spectacle.) Might implement events for how well they do, with maybe a big bonus to respect and prestige and maybe getting rid of the opinion malus. They won't come back though, because sending people offmap really just kills them and we can't reanimate the dead yet.
		only_playable = yes
		button_name = offmap_gifts
		
		third_party_filter = home_court
		ai_third_party_filter = home_court
		third_party = FROM
		ai_check_interval = 36
		show_third_party_potential = yes

		potential = {
			is_offmap_tag = offmap_aztecs
		}
	
		from_potential = {
			has_dlc = "Sunset Invasion"
			mercenary = no
			holy_order = no
			is_landed = yes
		}

		allow = {
			show_only_failed_conditions = yes
			custom_tooltip = { #Must be before Feb (~1 month travel time to Tenochtitlan)
				text = aztec_tribute_send_gladiator_must_be_before_february
				NOT = {
					month = 1
				}
			}
			custom_tooltip = { #Aztecs don't want to house/feed gladiators for the year. (May remove these if they prove too tedious)
				text = aztec_tribute_send_gladiator_must_be_after_december
				OR = {
					month = 11
					AND = {
						month = 0
					}
					
				}
			}
			FROM = {
				show_scope_change = no
				custom_tooltip = {
					text = aztec_tribute_send_gladiator_cooldown_tt
					NOT = { has_character_modifier = aztec_respect_send_gladiator_timer }
				}
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
			}
			# china_offmap_decisions_enabled_trigger = yes #leave in please, to be used if the tooltip for china_offmap_tribute_decisions_enabled_trigger changes and we need to reference things uniquely again
			aztec_offmap_tribute_decisions_enabled_trigger = yes
		}
		
		third_party_potential = {
			show_only_failed_conditions = yes
			FROMFROM = {
				show_scope_change = no
				custom_tooltip = {
					text = is_landless_male_tt
					NOT = { is_landed = yes }
					NOT = { is_ruler = yes }
					NOT = { is_female = yes }
					NOT = { is_patrician = yes }
				}
				is_adult = yes				
				NOT = { is_heir = yes }
				#custom_tooltip = { #can't be from Aztecs - TODO: Fix
				#	text = is_not_from_china_tt
				#	#NOT = {	has_character_flag = eunuch_gift }
				#	courtier_from_aztecs_trigger = no
				#}
				custom_tooltip = {
					text = is_not_incapable_inbred_or_imbecile_tt
					NOT = { trait = incapable }
					NOT = { trait = inbred }
					NOT = { trait = imbecile }
				}
				custom_tooltip = {
					text = is_not_maimed_or_infirm_tt
					NOT = { trait = maimed }
					NOT = { trait = infirm }
				}
				custom_tooltip = {
					text = is_not_wounded_severely_injured_tt
					NOT = { trait = wounded }
					NOT = { trait = severely_injured }
				}
				custom_tooltip = {
					text = is_not_one_eyed_handed_legged_disfigured_or_mangled_tt
					NOT = { trait = one_eyed }
					NOT = { trait = one_handed }
					NOT = { trait = one_legged }
					NOT = { trait = disfigured }
					NOT = { trait = mangled }
				}
				NOT = { prisoner = yes }

				custom_tooltip = {
					text = aztec_tribute_send_gladiator_stats_tt #High martial or decent martial education
					OR = {
						martial = 20
						trait = tough_soldier
						trait = skilled_tactician
						trait = brilliant_strategist
					}
				}
			}
		}
		
		third_party_allow = {
			show_only_failed_conditions = yes
			FROMFROM = {
				is_ill = no
				is_inaccessible_trigger = no
			}
		}
		
		third_party_score = {
			factor = 100
			
			additive_modifier = {
				value = 20
				FROMFROM = { 
					show_scope_change = no
					martial = 8					
					hidden_trigger = {
						NOT = { martial = 12 }
					}
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					martial = 12					
					hidden_trigger = {
						NOT = { martial = 16 }
					}
				}
			}
			additive_modifier = {
				value = 75
				FROMFROM = { 
					show_scope_change = no
					martial = 16				
					hidden_trigger = {
						NOT = { martial = 20 }
					}
				}
			}
			additive_modifier = {
				value = 120
				FROMFROM = { 
					show_scope_change = no
					martial = 20
				}
			}
			additive_modifier = {
				value = 20
				FROMFROM = { 
					show_scope_change = no
					trait = quick
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					trait = strong
				}
			}
			additive_modifier = {
				value = 20
				FROMFROM = {
					show_scope_change = no
					trait = robust
				}
			}
			additive_modifier = {
				value = 40
				FROMFROM = { 
					show_scope_change = no
					trait = strategist
				}
			}
			additive_modifier = {
				value = 25
				trait = skilled_tactician
			}
			additive_modifier = {
				value = 50
				trait = brilliant_strategist
			}
			additive_modifier = {
				value = -100
				trait = craven
			}
			additive_modifier = {
				value = 100
				trait = brave
			}
			additive_modifier = {
				value = -10
				trait = shy
			}
			additive_modifier = {
				value = 10
				trait = cruel
			}
			additive_modifier = {
				value = 10
				trait = impaler
			}
			additive_modifier = {
				value = 30
				trait = inspiring_leader
			}
			additive_modifier = {
				value = 100
				trait = trickster
			}
			additive_modifier = {
				value = 30
				trait = aggressive_leader
			}
			modifier = {
				factor = 2.0
				OR = {
					offmap_aztecs = {
						show_scope_change = no 
						offmap_has_like = likes_gladiators
					}
				}
			}
			modifier = {
				factor = 2.0
				FROMFROM = {
					show_scope_change = no 
					liked_by_offmap = {
			            type = offmap_aztecs
			        }
				}
			}
			modifier = {
				factor = 0.5
				offmap_aztecs = {
					show_scope_change = no 
					offmap_has_dislike = likes_gladiators
				}
			}
			modifier = {
				factor = 0.5
				FROMFROM = {
					show_scope_change = no 
					disliked_by_offmap = {
				        type = offmap_aztecs
				    }
				}
			}
			modifier = {
				factor = 1.5
				FROM = { 
					show_scope_change = no
					liked_by_offmap = {
						type = offmap_aztecs
					}
				}
			}
			modifier = {
				factor = 0.66
				FROM = {
					show_scope_change = no 
					disliked_by_offmap = {
						type = offmap_aztecs
					}
				}
			}
		}
	
		effect = {
			save_event_target_as = target_governor
			FROM = {
				sound_effect = aztec_respect_gain
				save_event_target_as = target_tribute_sender
			}
			FROMFROM = {
				save_event_target_as = person_sent_as_tribute
				any_close_relative = { #Should probably train the AI not to do this to close relatives/spouses of vassals.
					opinion = { modifier = sent_close_relative_to_death_by_combat who = FROM years = 20 }
				}
				spouse = {
					opinion = { modifier = sent_close_relative_to_death_by_combat who = FROM years = 20 }
				}
			}
			#if = {
			#	limit = {
			#		FROMFROM = { disliked_by_offmap = offmap_aztecs }
			#	}
			#	custom_tooltip = { text = notification_china_dislike_tt }
			#}
			#if = {
			#	limit = {
			#		NOT = { FROMFROM = { disliked_by_offmap = offmap_aztecs } }
			#		FROMFROM = { liked_by_offmap = offmap_aztecs }
			#	}
			#	custom_tooltip = { text = notification_china_like_tt }
			#}

			FROM = {
				show_scope_change = no
				add_offmap_currency = {
					offmap = offmap_aztecs
					value = local_third_party_score
				}
			}
			
			# Like/Dislike effect description
			#################################
			if = {
				limit = {
					OR = {
						FROM = {
							liked_by_offmap = {
								type = offmap_aztecs
								context = gladiator
							}
						}
						FROMFROM = {
							liked_by_offmap = {
								type = offmap_aztecs
								context = gladiator
							}
						}
					}
					NOR = {
						FROM = {
							disliked_by_offmap = {
								type = offmap_aztecs
								context = gladiator
							}
						}
						FROMFROM = {
							disliked_by_offmap = {
								type = offmap_aztecs
								context = gladiator
							}
						}
					}
				}
				e_aztec_colony = {
					show_scope_change = no
					offmap_power = {
						show_scope_change = no
						custom_tooltip = { text = likes_tt }
					}
				}
			}
			
			if = {
				limit = {
					OR = {
						FROM = {
							disliked_by_offmap = {
								type = offmap_aztecs
								context = gladiator
							}
						}
						FROMFROM = {
							disliked_by_offmap = {
								type = offmap_aztecs
								context = gladiator
							}
						}
					}
					NOR = {
						FROM = {
							liked_by_offmap = {
								type = offmap_aztecs
								context = gladiator
							}
						}
						FROMFROM = {
							liked_by_offmap = {
								type = offmap_aztecs
								context = gladiator
							}
						}
					}
				}
				e_china_west_governor = {
					show_scope_change = no
					offmap_power = {
						show_scope_change = no
						custom_tooltip = { text = dislikes_tt }
					}
				}
			}
			if = {
				limit = {
					OR = {
						FROM = {
							liked_by_offmap = {
								type = offmap_aztecs
								context = gladiator
							}
						}
						FROMFROM = {
							liked_by_offmap = {
								type = offmap_aztecs
								context = gladiator
							}
						}
					}
					OR = {
						FROM = {
							disliked_by_offmap = {
								type = offmap_aztecs
								context = gladiator
							}
						}
						FROMFROM = {
							disliked_by_offmap = {
								type = offmap_aztecs
								context = gladiator
							}
						}
					}
				}
				e_china_west_governor = {
					show_scope_change = no
					offmap_power = {
						show_scope_change = no
						custom_tooltip = { text = likes_but_dislikes_tt }
					}
				}
			}
			#################################
			
			FROMFROM = {
				show_scope_change = no
				#hidden_effect = { #May add an 'Aztec Gladiator' trait.
				#	if = {
				#		limit = {
				#			NOT = {
				#				trait = eunuch
				#			}
				#		}
				#		add_trait = eunuch
				#	}
				#}
				leave_court_for_aztecs_effect = yes
			}
			hidden_effect = {
				FROM = {
					add_character_modifier = {
						modifier = aztec_respect_send_gladiator_timer
						hidden = yes
						years = 20
					}
					if = {
						limit = { local_third_party_score_low_trigger = yes }
						set_character_flag = sent_bad_tribute
					}
					if = {
						limit = { local_third_party_score_medium_trigger = yes }
						set_character_flag = sent_decent_tribute
					}
					if = {
						limit = { local_third_party_score_great_trigger = yes }
						set_character_flag = sent_great_tribute
					}
					set_character_flag = sent_eunuch_tribute
					letter_event = { id = JD.10050 days = 5 random = 2 } #TODO: Write own event
				}
			}
		}
	
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.3 # slow down
			}
		}
	}
}

#Spending Respect
offmap_decisions = {
	aztec_respect_peace_deal = {
		only_playable = yes
		button_name = offmap_boons
		ai_check_interval = 12
	
		from_potential = {
			has_dlc = "Sunset Invasion"
			mercenary = no
			holy_order = no
			is_landed = yes
		}

		potential = {
			is_offmap_tag = offmap_aztecs
		}


		allow = {
			show_only_failed_conditions = yes
			FROM = {
				show_scope_change = no
				in_revolt = no
				independent = yes
				NOT = { pays_tribute_to = ROOT }
				has_offmap_currency = { offmap = offmap_aztecs value = 250 }
				custom_tooltip = {
					text = aztec_respect_peace_deal_allow_tt
					NOT = { has_character_modifier = peace_deal_with_aztecs }
				}
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
			}
			offmap_aztecs = {
				NOT = { has_policy = aztec_invaders }
			}
			aztec_offmap_boon_decisions_enabled_trigger = yes
		}

		effect = {
			FROM = {
				sound_effect = aztec_respect_spend #TODO: Get some nice aztec noise
				show_scope_change = no
				add_offmap_currency = {
					offmap = offmap_aztecs
					value = -250
				}
			} 
			custom_tooltip = { text = aztec_respect_peace_deal_effect_tt }
			hidden_effect = { offmap_aztecs = { governor = { character_event = { id = JD.20025 } } } }
			hidden_effect = { FROM = { set_aztec_boon_cd_effect = yes } }
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1 # slow down
			}
			modifier = { realm_levy_diff = { who = FROM value = 2000 } factor = 1.5 }
			modifier = { realm_levy_diff = { who = FROM value = 5000 } factor = 3 }
			modifier = {
				FROM = {
					NOT = { has_respect_major_trigger = yes }
				}
				factor = 0.1
			}
			modifier = {
				factor = 0
				FROM = {
					OR = {
						NAND = {
							any_neighbor_independent_ruler = {
								character = ROOT
							}
							capital_scope = {
								OR = {
									region = world_europe
								}
							}
						}
						NOT = {
							independent = yes
						}
						offmap_aztecs = {
							has_policy = aztec_traders
						}
					}
				}
			}
			modifier = {
				factor = 0
				FROM = {
					in_revolt = yes
				}
			}
		}
	}
	
	aztec_respect_doctor = {
		only_playable = yes
		button_name = offmap_boons
		ai_check_interval = 12

		from_potential = {
			has_dlc = "Sunset Invasion"
			has_dlc = Reapers
			mercenary = no
			holy_order = no
			is_landed = yes
		}

		potential = {
			is_offmap_tag = offmap_aztecs
		}

		allow = {
			show_only_failed_conditions = yes
			FROM = {
				show_scope_change = no
				has_offmap_currency = { offmap = offmap_aztecs value = 250 }
				custom_tooltip = {
					text = aztec_respect_doctor_allow_tt
					NOT = { any_courtier = { has_minor_title = title_court_physician } }
				}
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
			}
			aztec_offmap_boon_decisions_enabled_trigger = yes
		}

		effect = {
			FROM = {
				show_scope_change = no
				sound_effect = aztec_respect_spend
				add_offmap_currency = {
					offmap = offmap_aztecs
					value = -250
				}
			}
			hidden_effect = { offmap_aztecs = { governor = { character_event = { id = SI.20021 } } } } #TODO: transfer JD events to SI
			hidden_effect = { FROM = { set_aztec_boon_cd_effect = yes } }
		}

		ai_will_do = {
			factor = 0
			#factor = 1
			#modifier = {
			#	factor = 0.1 # slow down
			#}
			#modifier = {
			#	FROM = { NOT = { any_courtier = { learning = 15 } } }
			#	factor = 1.5
			#}
			#modifier = {
			#	FROM = {
			#		NOT = { any_courtier = { learning = 15 } }
			#		OR = {
			#			NOT = { health = 3 }
			#			character_disease_trigger = yes
			#			has_symptom_trigger = yes
			#		}
			#	}
			#	factor = 10
			#}
			#modifier = {
			#	FROM = {
			#		NOT = { has_grace_medium_trigger = yes }
			#	}
			#	factor = 0.1
			#}
		}
	}

	aztec_respect_warrior = {
		only_playable = yes
		button_name = offmap_boons
		ai_check_interval = 12

		from_potential = {
			has_dlc = "Sunset Invasion"
			#has_dlc = Reapers
			mercenary = no
			holy_order = no
			is_landed = yes
		}

		potential = {
			is_offmap_tag = offmap_aztecs
		}

		allow = {
			show_only_failed_conditions = yes
			FROM = {
				show_scope_change = no
				has_offmap_currency = { offmap = offmap_aztecs value = 250 }
				#custom_tooltip = {
				#	text = aztec_respect_warrior_allow_tt
				#	#NOT = { any_courtier = { has_minor_title = title_court_physician } }
				#	#NOT = { has_assigned_minor_title = { title = title_commander count = 3 } }
				#}
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
			}
			aztec_offmap_boon_decisions_enabled_trigger = yes
		}

		effect = {
			FROM = {
				show_scope_change = no
				sound_effect = aztec_respect_spend
				add_offmap_currency = {
					offmap = offmap_aztecs
					value = -250
				}
			}
			hidden_effect = { offmap_aztecs = { governor = { character_event = { id = SI.20023 } } } } 
			hidden_effect = { FROM = { set_aztec_boon_cd_effect = yes } }
		}

		ai_will_do = {
			factor = 0
			#factor = 1
			#modifier = {
			#	factor = 0.1 # slow down
			#}
			#modifier = {
			#	FROM = { NOT = { any_courtier = { learning = 15 } } }
			#	factor = 1.5
			#}
			#modifier = {
			#	FROM = {
			#		NOT = { any_courtier = { learning = 15 } }
			#		OR = {
			#			NOT = { health = 3 }
			#			character_disease_trigger = yes
			#			has_symptom_trigger = yes
			#		}
			#	}
			#	factor = 10
			#}
			#modifier = {
			#	FROM = {
			#		NOT = { has_grace_medium_trigger = yes }
			#	}
			#	factor = 0.1
			#}
		}
	}
}



targeted_decisions = {
	
	aztec_declare_amocuallitlacatl = { # Made up name for heretic: lit. "evil person"
		only_playable = yes
		from_potential = {
			religion = aztec
			controls_religion = yes
		}
		
		potential = {
			religion = aztec
			controls_religion = no
			
		}
		
		allow = {
			#wealth = 50
			NOT = { trait = amocuallitlacatl }
			FROM = {
				prestige = 500
				piety = 600
			}
			NOT = { 
				AND = {
					FROM = {
						ai = no
					}
					piety = 750 
				}
			}
		}
		
		effect = {
			ROOT = {
				add_trait = amocuallitlacatl
				piety = -500
				opinion = { modifier = sunset_declared_me_amocuallitlacatl who = ROOT }
			}
			FROM = {
				prestige = -500
			}
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				NOT = {
					ROOT = {
						OR = { #Bad traits or upset the tlatoani
							trait = cynical
							trait = craven
							trait = slothful
							reverse_opinion = {
								who = FROM 
								value = -75
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.5
				ROOT = {
					piety = 500
				}
			}
			modifier = {
				factor = 0.5
				ROOT = {
					piety = 1000
				}
			}
			modifier = {
				factor = 0.1
				ROOT = {
					piety = 1500
				}
			}
			modifier = {
				factor = 0.5
				ROOT = {
					has_offmap_currency = { offmap = offmap_aztecs value > 300 }
				}
			}
		}
	}
	
	aztec_lift_amocuallitlacatl = { # Made up name for heretic: lit. "evil person"
		only_playable = yes
		from_potential = {
			religion = aztec
			controls_religion = yes
		}
		
		potential = {
			religion = aztec
			controls_religion = no
			trait = amocuallitlacatl
		}
		
		allow = {
			#wealth = 50
			trait = amocuallitlacatl
			FROM = {
				prestige = 1000
				piety = 1100
			}
			NOT = { piety = 750 }
		}
		
		effect = {
			ROOT = {
				remove_trait = amocuallitlacatl
				piety = 250
				remove_opinion = { modifier = sunset_declared_me_amocuallitlacatl who = ROOT }
			}
			FROM = {
				prestige = -1000
				piety = -1000
			}
		}
		
		ai_will_do = {
			factor = 0.1
			modifier = {
				factor = 0
				ROOT = {
					OR = { #Bad traits or upset the tlatoani
						trait = cynical
						trait = craven
						trait = slothful
						reverse_opinion = {
							who = FROM 
							value = -75
						}
					}
				}
			}
			modifier = {
				factor = 1.5
				ROOT = {
					piety = 500
				}
			}
			modifier = {
				factor = 1.5
				ROOT = {
					piety = 1000
				}
			}
			modifier = {
				factor = 2
				ROOT = {
					piety = 1500
				}
			}
			modifier = {
				factor = 1.25
				ROOT = {
					has_offmap_currency = { offmap = offmap_aztecs value > 300 }
				}
			}
		}
	}
	
	
	
	
	# aztec_request_amocuallitlacatl = { # Made up name for heretic: lit. "evil person"
		# only_playable = yes
		# filter = rel_head
		# third_party_filter = independent_rulers
		# #filter = close_relatives
		# #ai_target_filter = close_relatives
		
		# only_rulers = yes
		
		# from_potential = {
			# #ai = no
			# is_playable = yes
			# #controls_religion = aztec
			# religion = aztec
			# is_adult = yes
			
			# #has_children = yes
			# #has_polygamy = no
		# }
		
		# third_party_potential = {
			# NOT = { trait = amocuallitlacatl }
			# religion = aztec
		# }
		
		# allow = {
			# FROMFROM = {
				# NOT = { opinion = { who = ROOT value = 0 } } # Must have negative opinion of person.
			# }
		# }
		# effect = {
			# FROMFROM = {
				# add_trait = amocuallitlacatl
				# piety = -500
				# opinion = {
					# modifier = sunset_declared_me_amocuallitlacatl
					# who = ROOT
				# }
			# }
		# }
		
		# revoke_allowed = {
			# always = no
		# }
		# ai_will_do = {
			# factor = 1
			# modifier = {
				# factor = 0
				# NOT = {
					# AND = {
						# FROM = {
							# trait = zealous
						# }
						# FROMFROM = {
							# OR = {
								# trait = cynical
								# trait = craven
								# trait = slothful
								# trait = homosexual
								# reverse_opinion = {
									# who = FROM 
									# value = -75
								# }
							# }
						# }
					# }
				# }
			# }
		# }
	# }
	
	# aztec_lift_amocuallitlacatl = { # Undo it
		# only_playable = yes
		# #filter = close_relatives
		# #ai_target_filter = close_relatives
		
		# only_rulers = yes
		
		# from_potential = {
			# #ai = no
			# is_playable = yes
			# controls_religion = aztec
			# religion = aztec
			# is_adult = yes
			
			# #has_children = yes
			# #has_polygamy = no
		# }
		
		# potential = {
			# trait = amocuallitlacatl
			# religion = aztec
		# }
		# allow = {
			# FROM = {
				# opinion = { who = ROOT value = 50 } # Must have good opinion of person.
			# }
		# }
		# effect = {
			# remove_trait = amocuallitlacatl
			# piety = 500
			# remove_opinion = {
				# modifier = sunset_declared_me_amocuallitlacatl
				# who = FROM
			# }
		# }
		
		# revoke_allowed = {
			# always = no
		# }
		# ai_will_do = {
			# factor = 0 # Don't do for now
			# # modifier = {
				# # factor = 0
				# # NOT = {
					# # AND = {
						# # FROM = {
							# # trait = zealous
						# # }
						# # ROOT = {
							# # OR = {
								# # trait = cynical
								# # trait = craven
								# # trait = slothful
								# # trait = homosexual
								# # reverse_opinion = { 
									# # who = FROM 
									# # value = -75
								# # }
							# # }
						# # }
					# # }
				# # }
			# # }
		# }
	# }
}

offmap_decisions = {
	
	aztecs_raid = {
		only_playable = yes
		button_name = offmap_hostility
		ai_check_interval = 36
	
		from_potential = {
			has_dlc = "Sunset Invasion"
			mercenary = no
			holy_order = no
			is_landed = yes
			NOT = {
				has_character_modifier = aztecs_raid_active
			}
		}

		potential = {
			is_offmap_tag = offmap_aztecs
		}

		allow = {
			show_only_failed_conditions = yes
			FROM = {
				show_scope_change = no
				independent = yes
				is_allowed_to_loot = yes
				NOT = {
					is_tributary = {
						type = offmap
						suzerain = ROOT
					}
				}
				NOT = { has_character_modifier = peace_deal_with_aztecs }
				custom_tooltip = {
					text = aztecs_respect_supply_horses_not_already_supplying_tt
					NOT = {
						has_character_modifier = aztecs_supply_horses
					}
				}
				custom_tooltip = { #Borders the eastern edge of the map
					text = chinese_grace_become_tributary_allow_chinese_influence_tt
					any_realm_province = {
						region = custom_aztec_invasion_target_region
					}
				}
				custom_tooltip = {
					text = aztecs_offmap_boon_decisions_enabled_trigger_raiding_tt
					NOT = {
						has_character_modifier = aztecs_raid_respect_cd
					}
				}
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
			}
			aztec_offmap_hostile_decisions_enabled_trigger = yes
		}

		effect = {
			save_event_target_as = target_governor
			FROM = {
				show_scope_change = no
				sound_effect = aztecs_angered_emperor
				add_offmap_currency = {
					offmap = offmap_aztecs
					value = -500
				}
				hidden_effect = {
					add_character_modifier = {
						inherit = yes
						name = aztecs_raid_active
						duration = -1
					}
				}
			}
			hidden_effect = { offmap_aztecs = { governor = { character_event = { id = JD.3050 } } } }
		}

		ai_will_do = {
			factor = 0.1
			modifier = {
				factor = 0
				FROM = {
					has_respect_medium_trigger = yes
				}
			}
			modifier = {
				factor = 0
				FROM = {
					OR = {
						trait = shy
						trait = content
						trait = craven
					}
				}
			}
			modifier = {
				factor = 0
				offmap_aztecs = { offmap_ruler = { dynasty = FROM } }
			}
		}
	}
	
	aztecs_stop_raid = {
		only_playable = yes
		button_name = offmap_hostility
		ai_check_interval = 36
	
		from_potential = {
			has_dlc = "Sunset Invasion"
			mercenary = no
			holy_order = no
			is_landed = yes
			has_character_modifier = aztecs_raid_active
		}

		potential = {
			is_offmap_tag = offmap_aztecs
		}

		allow = {
			show_only_failed_conditions = yes
			FROM = {
				has_character_modifier = aztecs_raid_active
			}
		}

		effect = {
			save_event_target_as = target_governor
			FROM = {
				show_scope_change = no
				sound_effect = aztecs_grace_gain
				remove_character_modifier = aztecs_raid_active
				hidden_effect = {
					add_character_modifier = {
						name = aztecs_raid_respect_cd
						hidden = yes
						years = 5
					}
				}
			}
		}

		ai_will_do = {
			factor = 0.1
			modifier = {
				factor = 10
				offmap_aztecs = { offmap_ruler = { dynasty = FROM } }
			}
			modifier = {
				factor = 0
				AND = {
					FROM = {
						NOR = {
							trait = shy
							trait = content
							trait = craven
						}
					}
					NOT = {
						offmap_aztecs = { offmap_ruler = { dynasty = FROM } }
					}
				}
			}
		}
	}

	aztecs_force_to_open = {
		only_playable = yes
		button_name = offmap_hostility
	
		from_potential = {
			ai = no
			has_dlc = "Sunset Invasion"
			mercenary = no
			holy_order = no
			is_landed = yes
		}

		potential = {
			is_offmap_tag = offmap_aztecs
			#offmap_aztecs = { has_policy = aztec_isolationist }
		}

		allow = {
			show_only_failed_conditions = yes
			FROM = {
				show_scope_change = no
				independent = yes
				NOT = {
					is_tributary = {
						type = offmap
						suzerain = ROOT
					}
				}
				custom_tooltip = {
					text = force_aztecs_open_cooldown_tt
					NOT = { has_character_modifier = aztecs_force_open_cooldown }
				}
				OR = {
					custom_tooltip = { #Borders the Western Governate
						text = chinese_grace_become_tributary_allow_governor_neighbor_tt
						any_neighbor_independent_ruler = {
							has_landed_title = e_aztec_colony
						}
					}
					custom_tooltip = { #Borders a Chinese tributary
						text = chinese_grace_become_tributary_allow_tributary_neighbor_tt
						any_neighbor_independent_ruler = {
							suzerain = {
								has_landed_title = e_aztec_colony
							}
						}
					}
					custom_tooltip = { #Borders the eastern edge of the map
						text = chinese_grace_become_tributary_allow_chinese_influence_tt
						any_realm_province = {
							region = custom_aztec_invasion_target_region
						}
					}
					custom_tooltip = { #Within diplo range of aztecs and has a port in India
						text = chinese_grace_become_tributary_allow_india_tt
						any_realm_province = { 
							port = yes 
							region = world_india
						}
					}
				}
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
			}
			offmap_aztecs = {
				has_policy = aztec_isolationist
			}
			offmap_aztecs = {
				custom_tooltip = {
					text = already_at_war_tt
					hidden_tooltip = {
						governor = {
							NOT = {
								any_war = {
									using_cb = force_open_aztecs_cb
								}
							}
						}
					}
				}
			}
			aztec_offmap_hostile_decisions_enabled_trigger = yes
		}

		effect = {
			save_event_target_as = target_governor
			hidden_effect = { offmap_aztecs = { set_offmap_tmp_flag = aztecs_force_open_in_progress } }
			FROM = { 
				sound_effect = aztecs_angered_emperor
				hidden_effect = { 
					add_character_modifier = { 
						name = aztecs_force_open_cooldown
						years = 15
						hidden = yes
					}
				}
				ROOT = {
					show_scope_change = no
					character_event = { id = JD.60300 tooltip = force_open_aztecs_start_tt }
				}
			}
		}

		ai_will_do = {
			factor = 0
		}
	}

	aztecs_tributary_break_free = {
		only_playable = yes
		button_name = offmap_hostility
	
		from_potential = {
			ai = no
			has_dlc = "Sunset Invasion"
			mercenary = no
			holy_order = no
			is_landed = yes
		}

		potential = {
			is_offmap_tag = offmap_aztecs
			FROM = {
				is_tributary = {
					type = offmap
					suzerain = ROOT
				}
			}
		}

		allow = {
			show_only_failed_conditions = yes
			FROM = {
				show_scope_change = yes
				is_tributary = {
					type = offmap
					suzerain = ROOT
				}
				can_use_cb = {
					target = ROOT
					casus_belli = free_tributary_cb
				}
				#NOT = { is_decision_allowed = tributary_independence_aztecs }
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
			}
			aztec_offmap_hostile_decisions_enabled_trigger = yes
		}

		effect = {
			FROM = {
				show_scope_change = no
				sound_effect = aztecs_angered_emperor
				war = {
					target = ROOT
					casus_belli = free_tributary_cb
				}
			}
		}

		ai_will_do = {
			factor = 0
		}
	}

	aztecs_invade_teocallicpalli = {
		only_playable = yes
		button_name = offmap_hostility
		
		third_party_filter = home_court
		ai_third_party_filter = home_court
		third_party = FROM
		show_third_party_potential = yes
	
		from_potential = {
			ai = no
			has_dlc = "Sunset Invasion"
			mercenary = no
			holy_order = no
		}

		potential = {
			is_offmap_tag = offmap_aztecs
			NOT = { 
				offmap_aztecs = {
					offmap_ruler = { dynasty = FROM } 
				}
			}
		}

		allow = {
			show_only_failed_conditions = yes
			FROM = {
				show_scope_change = no
				independent = yes
				in_revolt = no
				NOT = {
					is_tributary = {
						type = offmap
						suzerain = ROOT
					}
				}
				#OR = {
				custom_tooltip = { #Borders the Western Governate
					text = aztec_respect_become_tributary_allow_governor_neighbor_tt
					any_neighbor_independent_ruler = {
						has_landed_title = e_aztec_colony
					}
				}
				#	custom_tooltip = { #Borders the eastern edge of the map #TODO Make this evaluate Navay size (Need to get there to do stuff)
				#		text = aztecs_invade_teocallicpalli_eastern_edge_tt
				#		any_realm_province = {
				#			region = custom_eastern_edge_of_map
				#		}
				#	}
				#}
				custom_tooltip = {
					text = aztecs_invade_teocallicpalli_failed_tt
					NOT = { has_character_modifier = failed_invasion_of_aztecs }
				}
				can_use_cb = {
					target = ROOT
					casus_belli = invasion_of_aztecs_cb
					only_check_triggers = yes
				}
				NOT = { has_raised_levies = THIS }
				custom_tooltip = {
					text = aztecs_invade_teocallicpalli_levies_tt
					NOT = { any_vassal = { ROOT_FROM = { has_raised_levies = PREV } } }
				}
				NOT = { has_truce = ROOT }
				tier = EMPEROR
				conditional_tooltip = {
					trigger = { is_nomadic = no }
					realm_size = 300
				}
				conditional_tooltip = {
					trigger = { is_nomadic = yes }
					num_of_count_titles_in_realm = 50
				}
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
			}
			aztec_offmap_hostile_decisions_enabled_trigger = yes
			offmap_aztecs = {
				OR = {
					has_status = aztec_stable
					has_status = aztec_golden_age
				}
				ROOT = {
					show_scope_change = no
					custom_tooltip = {
						text = aztecs_invade_teocallicpalli_war_tt #teocalli-chair, as Motezuma II's throne was designed to look like a teocalli
						NOT = { any_war = { using_cb = invasion_of_aztecs_cb } }
					}
				}
			}
		}

		third_party_potential = {
			show_only_failed_conditions = yes
			FROMFROM = {
				show_scope_change = no
				dynasty = ROOT_FROM
				is_adult = yes
				NOR = {
					courtier_from_aztecs_trigger = yes
					is_landed = yes
					is_incapable = yes
					trait = inbred
					trait = imbecile
					trait = celibate
					is_ascetic_trigger = yes
					prisoner = yes
				}
				is_primary_heir = no
			}
		}
		
		third_party_allow = {
			show_only_failed_conditions = yes		
			FROMFROM = {
				is_ill = no
				is_inaccessible_trigger = no
			}
		}

		effect = {
			hidden_effect = {
				FROMFROM = { #Stop them from moving, marrying or being diplomatically dealt with
					set_character_flag = invasion_aztecs_claimant
					set_character_flag = no_court_invites
					add_trait = cannot_marry
					diplomatic_immunity = yes
					save_global_event_target_as = invasion_of_aztecs_claimant
				}
				ROOT = { #Set amount of troops
					set_offmap_tmp_flag = aztecs_war_variables_set
					set_variable = {
						which = aztecs_war_troop_quantity
						value = 15
						# 15 regiments of ~500 units
					}
					set_variable = {
						which = aztecs_war_target_match_mult
						value = 2
					}
					set_variable = {
						which = aztecs_war_troop_quality
						value = 6
						# Value between 1-7
					}
					set_variable = {
						which = aztecs_war_minimum_commander_martial
						value = 16
					}
					set_variable = { #Minimum 80k
						which = aztecs_war_troop_quantity_override
						value = 160
					}
					save_event_target_as = invasion_of_aztecs_govenor
				}
			}
			FROM = {
				show_scope_change = no
				sound_effect = aztecs_angered_emperor
				save_event_target_as = invasion_of_aztecs_attacker
				custom_tooltip = {
					text = aztecs_invade_teocallicpalli_modifiers_tt
					hidden_effect = {
						set_offmap_currency = { offmap = offmap_aztecs value = 0 }
						remove_character_modifier = peace_deal_with_aztecs
						remove_character_modifier = chinese_grace_send_gift_timer
						remove_character_modifier = chinese_grace_send_eunuch_timer
						remove_character_modifier = chinese_grace_send_concubine_timer
						remove_character_modifier = chinese_grace_tributary_timer
						remove_character_modifier = si_aztecs_boon_cd
						remove_character_modifier = aztecs_force_open_cooldown
						remove_character_modifier = angered_aztecs_modifier
						remove_character_modifier = chinese_imperial_trade_contract
					}
				}
				hidden_effect = {
					add_character_modifier = {
						name = war_with_aztecs_modifier
						inherit = yes
						duration = -1
					}
					war = {
						target = ROOT
						casus_belli = invasion_of_aztecs_cb
					}
				}
			}
			hidden_effect = {
				any_player = {
					limit = {
						has_offmap_news_enabled = offmap_aztecs
						is_within_diplo_range = ROOT
					}
					narrative_event = { id = JD.60400 }
				}
			}
		}

		ai_will_do = {
			factor = 0
		}
	}
}