decisions = {
	convert_to_aztec_religion = {
		only_playable = yes
		ai_check_interval = 6
		
		#is_high_prio = yes
		
		potential = {
			is_playable = yes
			NOT = { religion_authority = 1 }
			controls_religion = no
			de_facto_liege_title = e_aztec_colony
			NOT = {
				religion = aztec
			}
		}
		
		allow = {
			NOT = { trait = zealous }
		}
		
		effect = {
			prestige = -500
			piety = 100
			religion_authority = {
				modifier = ruler_converted_from
			}
			
			
			if = {
				limit = {  NOT = { religion_group = mesoamerican_group } }
				if = {
					limit = { religion_group = pagan_group }
					add_trait = sympathy_pagans
				}
				
				if = {
					limit = { religion_group = zoroastrian_group }
					add_trait = sympathy_zoroastrianism
				}
				
				if = {
					limit = { religion_group = christian }
					add_trait = sympathy_christendom
				}
				
				if = {
					limit = { religion_group = muslim }
					add_trait = sympathy_islam
				}
				
				if = {
					limit = { religion_group = jewish_group }
					add_trait = sympathy_judaism
				}
				
				if = {
					limit = { religion_group = indian_group }
					add_trait = sympathy_indian
				}
			}
			
			religion = aztec
			capital_scope = {
				religion = aztec
			}
			any_courtier_or_vassal = {
				character_event = { id = misc_american.1 }
			}
			
			hidden_tooltip = {
				religion_authority = {
					modifier = ruler_converted_to
				}
			}
			
			
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.05
				is_hard_to_convert = yes
			}
			modifier = {
				factor = 2
				NOT = { higher_real_tier_than = 3 }
			}
		}
	}
	
	
	aztec_sends_reinforcements = {
		ai_check_interval = 2
		only_independent = yes
		potential = {
			#ai = yes
			war = yes
			offmap_aztecs = {
				governor = {
					character = ROOT
				}
				OR = {
					NOT = {
						# Only spawn reinforcements once
						has_offmap_flag = aztecs_sent_war_reinforcements
						# Exception: Really long wars
					}
					had_offmap_tmp_flag = {
						flag = aztecs_sent_war_reinforcements
						years = 30
					}
				}
				# Don't spawn reinforcements for the following statuses in China.
				NOR = {
					has_status = aztec_famine
					has_status = aztec_civil_war
					has_status = aztec_mayan_invasion
					has_status = aztec_incan_invasion
					has_status = aztec_norse_invasion
					has_status = aztec_iroquian_invasion
					has_status = aztec_plague
				}
			}
			# Only if Aztec Empire is losing a war by 50 war score.
			any_war = {
				OR = {
					AND = {
						attacker = {
							character = ROOT
						}
						NOT = { war_score = -49 }
					}
					AND = {
						defender = {
							character = ROOT
						}
						war_score = 50
					}
				}
			}
		}
		allow = {
		}
		effect = {
			set_variable = {
				which = aztec_troop_number
				value = 2 # 10k Troops, 5.5k per val.
			}
			capital_scope = {
				spawn_aztec_reinforcement_effect = yes
			}
			offmap_aztecs = {
				set_offmap_flag = aztecs_sent_war_reinforcements
			}
		}
	}
	
	
}
#Gaining Respect
offmap_decisions = {

	
	aztec_respect_become_tributary = {
		only_independent = yes
		button_name = offmap_gifts
		ai_check_interval = 12

		potential = {
			is_offmap_tag = offmap_aztecs
		}
	
		from_potential = {
			independent = yes
			#has_dlc = "Jade Dragon"
			mercenary = no
			holy_order = no
			is_landed = yes
		}

		allow = {
			show_only_failed_conditions = yes
			FROM = {
				show_scope_change = no
				war = no
				OR = {
					custom_tooltip = { #Borders the Colony
						text = aztec_respect_become_tributary_allow_colony_neighbor_tt
						any_neighbor_independent_ruler = {
							has_landed_title = e_aztec_colony
						}
					}
					custom_tooltip = { #Borders a Chinese tributary
						text = aztec_respect_become_tributary_allow_tributary_neighbor_tt
						any_neighbor_independent_ruler = {
							suzerain = {
								has_landed_title = e_aztec_colony
							}
						}
					}
					# custom_tooltip = { #Borders the eastern edge of the map
						# text = aztec_respect_become_tributary_allow_chinese_influence_tt
						# any_realm_province = {
							# region = custom_chinese_invasion_target_region
						# }
					# }
					custom_tooltip = { #Within diplo range of China and has a port in India
						text = aztec_respect_become_tributary_allow_europe_tt
						any_realm_province = { 
							port = yes 
							region = world_europe
						}
					}
				}
				custom_tooltip = {
					text = aztec_respect_become_tributary_allow_suzerain_tt
					NOT = {
						is_tributary = yes
					}
				}
				NOT = { tier = emperor }
				custom_tooltip = {
					text = aztec_respect_become_tributary_cooldown_tt
					NOT = { has_character_modifier = aztec_respect_tributary_timer }
				}
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
			}
			# china_offmap_decisions_enabled_trigger = yes #leave in please, to be used if the tooltip for china_offmap_tribute_decisions_enabled_trigger changes and we need to reference things uniquely again
			aztec_offmap_tribute_decisions_enabled_trigger = yes
		}

		effect = {
			log = "---------------------"
			log = "Aztec Logging:"
			log = "[From.GetTitledName] has voluntarily become a tributary of the [offmap_aztecs.GetFullname]"
			log = "---------------------"
			make_tributary = {
				who = FROM
				tributary_type = aztec_offmap_trib
			}
			#hidden_effect = { offmap_aztecs = { governor = { character_event = { id = JD.20027 } } } } #CONVERT THIS TO A SI NARRATIVE EVENT
			custom_tooltip = { text = aztec_respect_become_tributary_effect_TT }
			FROM = {
				show_scope_change = no
				sound_effect = aztec_respect_gain
				tooltip = {
					if = {
						limit = {
							liked_by_offmap = {
								type = offmap_aztecs
								context = tributary
							}
							NOT = {
								disliked_by_offmap = {
									type = offmap_aztecs
									context = tributary
								}
							}
						}
						add_offmap_currency = {
							offmap = offmap_aztecs
							value = 400
						}
						e_aztec_colony = {
							show_scope_change = no
							offmap_power = {
								show_scope_change = no
								custom_tooltip = { text = likes_tt }
							}
						}
					}
					if = {
						limit = {
							disliked_by_offmap = {
								type = offmap_aztecs
								context = tributary
							}
							NOT = {
								liked_by_offmap = {
									type = offmap_aztecs
									context = tributary
								}
							}
						}
						add_offmap_currency = {
							offmap = offmap_aztecs
							value = 100
						}
						e_aztec_colony = {
							show_scope_change = no
							offmap_power = {
								show_scope_change = no
								custom_tooltip = { text = dislikes_tt }
							}
						}
					}
					if = {
						limit = {
							liked_by_offmap = {
								type = offmap_aztecs
								context = tributary
							}
							disliked_by_offmap = {
								type = offmap_aztecs
								context = tributary
							}
						}
						add_offmap_currency = {
							offmap = offmap_aztecs
							value = 200
						}
						e_aztec_colony = {
							show_scope_change = no
							offmap_power = {
								show_scope_change = no
								custom_tooltip = { text = likes_but_dislikes_tt }
							}
						}
					}
					if = {
						limit = {
							NOR = {
								liked_by_offmap = {
									type = offmap_aztecs
									context = tributary
								}
								disliked_by_offmap = {
									type = offmap_aztecs
									context = tributary
								}
							}
						}
						add_offmap_currency = {
							offmap = offmap_aztecs
							value = 200
						}
					}
				}
			}
		}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 0
			#modifier = {
			#	factor = 0.01 # slow down
			#}
			#modifier = { realm_levy_diff = { who = FROM value = 2000 } factor = 1.5 }
			#modifier = { realm_levy_diff = { who = FROM value = 5000 } factor = 3 }
		}
	}
}

#Spending Respect
offmap_decisions = {
	aztec_respect_peace_deal = {
		only_playable = yes
		button_name = offmap_boons
		ai_check_interval = 12
	
		from_potential = {
			has_dlc = "Sunset Invasion"
			mercenary = no
			holy_order = no
			is_landed = yes
		}

		potential = {
			is_offmap_tag = offmap_aztecs
		}

#		potential = {
#			offmap_aztecs = { governor = { character = ROOT } }
#		}

		allow = {
			show_only_failed_conditions = yes
			FROM = {
				show_scope_change = no
				in_revolt = no
				independent = yes
				NOT = { pays_tribute_to = ROOT }
				has_offmap_currency = { offmap = offmap_aztecs value = 250 }
				custom_tooltip = {
					text = aztec_respect_peace_deal_allow_tt
					NOT = { has_character_modifier = peace_deal_with_aztecs }
				}
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
			}
			offmap_aztecs = {
				NOT = { has_policy = aztec_invaders }
			}
			aztec_offmap_boon_decisions_enabled_trigger = yes
		}

		effect = {
			FROM = {
				sound_effect = aztec_respect_spend #TODO: Get some nice aztec noise
				show_scope_change = no
				add_offmap_currency = {
					offmap = offmap_aztecs
					value = -250
				}
			} 
			custom_tooltip = { text = aztec_respect_peace_deal_effect_tt }
			hidden_effect = { offmap_aztecs = { governor = { character_event = { id = JD.20025 } } } }
			hidden_effect = { FROM = { set_aztec_boon_cd_effect = yes } }
		}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1 # slow down
			}
			modifier = { realm_levy_diff = { who = FROM value = 2000 } factor = 1.5 }
			modifier = { realm_levy_diff = { who = FROM value = 5000 } factor = 3 }
			modifier = {
				FROM = {
					NOT = { has_respect_major_trigger = yes }
				}
				factor = 0.1
			}
			modifier = {
				factor = 0
				FROM = {
					OR = {
						NAND = {
							any_neighbor_independent_ruler = {
								character = ROOT
							}
							capital_scope = {
								OR = {
									region = world_europe
								}
							}
						}
						NOT = {
							independent = yes
						}
						offmap_aztecs = {
							has_policy = aztec_traders
						}
					}
				}
			}
			modifier = {
				factor = 0
				FROM = {
					in_revolt = yes
				}
			}
		}
	}
	
	aztec_respect_doctor = {
		only_playable = yes
		button_name = offmap_boons
		ai_check_interval = 12

		from_potential = {
			has_dlc = "Sunset Invasion"
			has_dlc = Reapers
			mercenary = no
			holy_order = no
			is_landed = yes
		}

		potential = {
			is_offmap_tag = offmap_aztecs
		}

#		potential = {
#			offmap_aztecs = { governor = { character = ROOT } }
#		}

		allow = {
			show_only_failed_conditions = yes
			FROM = {
				show_scope_change = no
				has_offmap_currency = { offmap = offmap_aztecs value = 250 }
				custom_tooltip = {
					text = aztec_respect_doctor_allow_tt
					NOT = { any_courtier = { has_minor_title = title_court_physician } }
				}
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
			}
			aztec_offmap_boon_decisions_enabled_trigger = yes
		}

		effect = {
			FROM = {
				show_scope_change = no
				sound_effect = aztec_respect_spend
				add_offmap_currency = {
					offmap = offmap_aztecs
					value = -250
				}
			}
			hidden_effect = { offmap_aztecs = { governor = { character_event = { id = JD.20021 } } } } #TODO transfer JD events to SI
			hidden_effect = { FROM = { set_china_boon_cd_effect = yes } }
		}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 0
			#factor = 1
			#modifier = {
			#	factor = 0.1 # slow down
			#}
			#modifier = {
			#	FROM = { NOT = { any_courtier = { learning = 15 } } }
			#	factor = 1.5
			#}
			#modifier = {
			#	FROM = {
			#		NOT = { any_courtier = { learning = 15 } }
			#		OR = {
			#			NOT = { health = 3 }
			#			character_disease_trigger = yes
			#			has_symptom_trigger = yes
			#		}
			#	}
			#	factor = 10
			#}
			#modifier = {
			#	FROM = {
			#		NOT = { has_grace_medium_trigger = yes }
			#	}
			#	factor = 0.1
			#}
		}
	}
}



targeted_decisions = {
	
	aztec_proclaim_amocuallitlacatl = { # Made up name for heretic: lit. "evil person"
		only_playable = yes
		#filter = close_relatives
		#ai_target_filter = close_relatives
		
		only_rulers = yes
		
		from_potential = {
			#ai = no
			is_playable = yes
			controls_religion = aztec
			religion = aztec
			is_adult = yes
			
			#has_children = yes
			#has_polygamy = no
		}
		
		potential = {
			NOT = { trait = amocuallitlacatl }
			religion = aztec
		}
		allow = {
			FROM = {
				NOT = { opinion = { who = ROOT value = 0 } } # Must have negative opinion of person.
			}
		}
		effect = {
			add_trait = amocuallitlacatl
			piety = -500
			opinion = {
				modifier = sunset_declared_me_amocuallitlacatl
				who = FROM
			}
		}
		
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				NOT = {
					AND = {
						FROM = {
							has_trait = zealous
						}
						ROOT = {
							OR = {
								has_trait = cynical
								has_trait = craven
								has_trait = slothful
								has_trait = homosexual
								reverse_opinion = { 
									who = FROM 
									value = -75
								}
							}
						}
					}
				}
			}
		}
	}
	
	aztec_lift_amocuallitlacatl = { # Undo it
		only_playable = yes
		#filter = close_relatives
		#ai_target_filter = close_relatives
		
		only_rulers = yes
		
		from_potential = {
			#ai = no
			is_playable = yes
			controls_religion = aztec
			religion = aztec
			is_adult = yes
			
			#has_children = yes
			#has_polygamy = no
		}
		
		potential = {
			trait = amocuallitlacatl
			religion = aztec
		}
		allow = {
			FROM = {
				opinion = { who = ROOT value = 50 } # Must have good opinion of person.
			}
		}
		effect = {
			remove_trait = amocuallitlacatl
			piety = 500
			remove_opinion = {
				modifier = sunset_declared_me_amocuallitlacatl
				who = FROM
			}
		}
		
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0 # Don't do for now
			# modifier = {
				# factor = 0
				# NOT = {
					# AND = {
						# FROM = {
							# has_trait = zealous
						# }
						# ROOT = {
							# OR = {
								# has_trait = cynical
								# has_trait = craven
								# has_trait = slothful
								# has_trait = homosexual
								# reverse_opinion = { 
									# who = FROM 
									# value = -75
								# }
							# }
						# }
					# }
				# }
			# }
		}
	}
}