decisions = {
	convert_to_aztec_religion = {
		only_playable = yes
		ai_check_interval = 6
		
		#is_high_prio = yes
		
		potential = {
			is_playable = yes
			NOT = { religion_authority = 1 }
			controls_religion = no
			de_facto_liege_title = e_aztec_colony
			NOT = {
				religion = aztec
			}
		}
		
		allow = {
			NOT = { trait = zealous }
		}
		
		effect = {
			prestige = -500
			piety = 100
			religion_authority = {
				modifier = ruler_converted_from
			}
			
			
			if = {
				limit = {  NOT = { religion_group = mesoamerican_group } }
				if = {
					limit = { religion_group = pagan_group }
					add_trait = sympathy_pagans
				}
				
				if = {
					limit = { religion_group = zoroastrian_group }
					add_trait = sympathy_zoroastrianism
				}
				
				if = {
					limit = { religion_group = christian }
					add_trait = sympathy_christendom
				}
				
				if = {
					limit = { religion_group = muslim }
					add_trait = sympathy_islam
				}
				
				if = {
					limit = { religion_group = jewish_group }
					add_trait = sympathy_judaism
				}
				
				if = {
					limit = { religion_group = indian_group }
					add_trait = sympathy_indian
				}
			}
			
			religion = aztec
			capital_scope = {
				religion = aztec
			}
			any_courtier_or_vassal = {
				character_event = { id = misc_american.1 }
			}
			
			hidden_tooltip = {
				religion_authority = {
					modifier = ruler_converted_to
				}
			}
			
			
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.05
				is_hard_to_convert = yes
			}
			modifier = {
				factor = 2
				NOT = { higher_real_tier_than = 3 }
			}
		}
	}
	
	
	china_sends_reinforcements = {
		ai_check_interval = 2
		only_independent = yes
		potential = {
			ai = yes
			war = yes
			offmap_aztecs = {
				governor = {
					character = ROOT
				}
				OR = {
					NOT = {
						# Only spawn reinforcements once
						has_offmap_flag = aztecs_sent_war_reinforcements
						# Exception: Really long wars
					}
					had_offmap_tmp_flag = {
						flag = aztecs_sent_war_reinforcements
						years = 30
					}
				}
				# Don't spawn reinforcements for the following statuses in China.
				NOR = {
					has_status = aztec_famine
					has_status = aztec_civil_war
					has_status = aztec_mayan_invasion
					has_status = aztec_incan_invasion
					has_status = aztec_norse_invasion
					has_status = aztec_iroquian_invasion
					has_status = aztec_plague
				}
			}
			# Only if China is losing a war by 50 war score.
			any_war = {
				OR = {
					AND = {
						attacker = {
							character = ROOT
						}
						NOT = { war_score = -49 }
					}
					AND = {
						defender = {
							character = ROOT
						}
						war_score = 50
					}
				}
			}
		}
		allow = {
		}
		effect = {
			set_variable = {
				which = aztec_troop_number
				value = 2 # 10k Troops, 5.5k per val.
			}
			spawn_aztec_reinforcement_effect = yes
		}
	}
}

offmap_decisions = {
	aztec_respect_become_tributary = {
		only_independent = yes
		button_name = offmap_gifts
		ai_check_interval = 12

		potential = {
			is_offmap_tag = offmap_aztecs
		}
	
		from_potential = {
			independent = yes
			#has_dlc = "Jade Dragon"
			mercenary = no
			holy_order = no
			is_landed = yes
		}

		allow = {
			show_only_failed_conditions = yes
			FROM = {
				show_scope_change = no
				war = no
				OR = {
					custom_tooltip = { #Borders the Colony
						text = aztec_respect_become_tributary_allow_colony_neighbor_tt
						any_neighbor_independent_ruler = {
							has_landed_title = e_aztec_colony
						}
					}
					custom_tooltip = { #Borders a Chinese tributary
						text = aztec_respect_become_tributary_allow_tributary_neighbor_tt
						any_neighbor_independent_ruler = {
							suzerain = {
								has_landed_title = e_aztec_colony
							}
						}
					}
					# custom_tooltip = { #Borders the eastern edge of the map
						# text = chinese_grace_become_tributary_allow_chinese_influence_tt
						# any_realm_province = {
							# region = custom_chinese_invasion_target_region
						# }
					# }
					custom_tooltip = { #Within diplo range of China and has a port in India
						text = aztec_respect_become_tributary_allow_europe_tt
						any_realm_province = { 
							port = yes 
							region = world_europe
						}
					}
				}
				custom_tooltip = {
					text = aztec_respect_become_tributary_allow_suzerain_tt
					NOT = {
						is_tributary = yes
					}
				}
				NOT = { tier = emperor }
				custom_tooltip = {
					text = aztec_respect_become_tributary_cooldown_tt
					NOT = { has_character_modifier = aztec_respect_tributary_timer }
				}
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
			}
			# china_offmap_decisions_enabled_trigger = yes #leave in please, to be used if the tooltip for china_offmap_tribute_decisions_enabled_trigger changes and we need to reference things uniquely again
			aztec_respect_tribute_decisions_enabled_trigger = yes
		}

		effect = {
			log = "---------------------"
			log = "Aztec Logging:"
			log = "[From.GetTitledName] has voluntarily become a tributary of the [offmap_aztecs.GetFullname]"
			log = "---------------------"
			make_tributary = {
				who = FROM
				tributary_type = aztec_offmap_trib
			}
			#hidden_effect = { offmap_aztecs = { governor = { character_event = { id = JD.20027 } } } } #CONVERT THIS TO A SI NARRATIVE EVENT
			custom_tooltip = { text = aztec_respect_become_tributary_effect_TT }
			FROM = {
				show_scope_change = no
				sound_effect = china_grace_gain
				tooltip = {
					if = {
						limit = {
							liked_by_offmap = {
								type = offmap_aztecs
								context = tributary
							}
							NOT = {
								disliked_by_offmap = {
									type = offmap_aztecs
									context = tributary
								}
							}
						}
						add_offmap_currency = {
							offmap = offmap_aztecs
							value = 400
						}
						e_aztec_colony = {
							show_scope_change = no
							offmap_power = {
								show_scope_change = no
								custom_tooltip = { text = likes_tt }
							}
						}
					}
					if = {
						limit = {
							disliked_by_offmap = {
								type = offmap_aztecs
								context = tributary
							}
							NOT = {
								liked_by_offmap = {
									type = offmap_aztecs
									context = tributary
								}
							}
						}
						add_offmap_currency = {
							offmap = offmap_aztecs
							value = 100
						}
						e_aztec_colony = {
							show_scope_change = no
							offmap_power = {
								show_scope_change = no
								custom_tooltip = { text = dislikes_tt }
							}
						}
					}
					if = {
						limit = {
							liked_by_offmap = {
								type = offmap_aztecs
								context = tributary
							}
							disliked_by_offmap = {
								type = offmap_aztecs
								context = tributary
							}
						}
						add_offmap_currency = {
							offmap = offmap_aztecs
							value = 200
						}
						e_aztec_colony = {
							show_scope_change = no
							offmap_power = {
								show_scope_change = no
								custom_tooltip = { text = likes_but_dislikes_tt }
							}
						}
					}
					if = {
						limit = {
							NOR = {
								liked_by_offmap = {
									type = offmap_aztecs
									context = tributary
								}
								disliked_by_offmap = {
									type = offmap_aztecs
									context = tributary
								}
							}
						}
						add_offmap_currency = {
							offmap = offmap_aztecs
							value = 200
						}
					}
				}
			}
		}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 0
			#modifier = {
			#	factor = 0.01 # slow down
			#}
			#modifier = { realm_levy_diff = { who = FROM value = 2000 } factor = 1.5 }
			#modifier = { realm_levy_diff = { who = FROM value = 5000 } factor = 3 }
		}
	}
}